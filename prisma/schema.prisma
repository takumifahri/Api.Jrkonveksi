// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                Int                @id @default(autoincrement())
  unique_id         String               @unique @default(cuid())
  email             String               @unique
  roleId            Int                  @default(1)
  name              String               @db.VarChar(255)
  address           String?              
  phone             String?                 
  password          String

  // Security 
  login_attempt     Int?                @default(0)
  last_login        DateTime?            
  token_version Int     @default(0)   // ‚Üê new field
  
  // FK Relations
  role              Role                 @relation(fields: [roleId], references: [id])

  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime?

  ResponseContact   ResponseContact[]

}

model Role {
    id                Int                  @id @default(autoincrement())
  name  String 
  description  String 
  
  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime?
  
  // Relations
  users       User[]

}

enum StatusMaterial {
  HABIS
  AVAILABLE
}

model Materials {
  id                Int                  @id @default(autoincrement())
  unique_id         String               @unique
  status            StatusMaterial
  description       String 
  name              String               @db.VarChar(255)

  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime? 
}

model ContactForm {
  id                Int                  @id @default(autoincrement())
  unique_id         String               @unique
  name  String 
  email             String   
  phone             String                  
  title             String               @db.VarChar(255)
  Message           String  

  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime? 

  // Relations
  response          ResponseContact[]

}


model ResponseContact {
  id                Int                  @id @default(autoincrement())
  unique_id         String               @unique
  contacatId        Int        
  RespondenId       Int        
          
  name              String 
  email             String   
  phone             String                  
  title             String               @db.VarChar(255)
  Message           String  

  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @updatedAt
  deletedAt         DateTime? 

  ContactForm       ContactForm          @relation(fields: [contacatId], references: [id])
  user              User                 @relation(fields: [RespondenId], references: [id])
}